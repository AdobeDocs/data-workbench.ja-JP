---
description: Microsoft Windows Server 2008 以降で実行しているMicrosoft IIS 7.x または 8.x 用のセンサーをインストールし、設定します。
title: Microsoft IIS（Windows Server 2008 以降）
uuid: 7fd8da68-1553-4395-b13e-b08a6ee1948e
exl-id: cc909daa-60c0-4188-8e90-035c41bf3105
source-git-commit: b1dda69a606a16dccca30d2a74c7e63dbd27936c
workflow-type: tm+mt
source-wordcount: '1589'
ht-degree: 1%

---

# Microsoft IIS（Windows Server 2008 以降）{#microsoft-iis-on-windows-server-or-later}

{{eol}}

Microsoft Windows Server 2008 以降で実行しているMicrosoft IIS 7.x または 8.x 用のセンサーをインストールし、設定します。

Sensor のプログラムファイルは、インストールファイルにパッケージ化され、Adobeダウンロードサイトから入手できます。 ご使用の Web サーバー用の Sensor インストールファイルがまだない場合は、次の手順を開始する前に、そのファイルをダウンロード ( またはAdobe担当者から入手 ) してください。

Sensor をインストールして設定するには、次の大まかな手順を実行する必要があります。

1. [プログラムファイルをインストールする](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-cb51e5932a6d40c5b00758a7a51b7578)
1. [Sensor 設定ファイルを編集します。](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-1e1590a92222430e92066292512ae0df)
1. [トランスミッターを起動し、ディスクキューを作成します。](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-2b8dfd06996d4ab49998eeb99bd9f5f0)
1. [Web サーバーにコレクターを追加する](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-088960c986cf449cb712152298b3518d)
1. [追加データのキャプチャ](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-98db9625efdc4b60bfd76f7adf4af74d)

## プログラムファイルをインストールする {#section-cb51e5932a6d40c5b00758a7a51b7578}

Windows IIS で Sensor を実行する場合、プログラムファイルとディスクキューファイルは同じディレクトリに存在する必要があります。

プログラムファイルをインストールする前に、まず、ディスクキューを保持する場所を決定します。これは、プログラムファイルをインストールする必要がある場所です。

次の手順を実行して、Sensor 用のプログラムファイルを抽出し、インストールします。

1. Windows マシン上に、Sensor プログラムファイルをインストールするディレクトリを作成します。 ディスクキューもこのディレクトリに存在するので、選択したデバイスに必要なサイズのキューを保持するのに十分な空き容量があることを確認してください。

   例：C:\VisualSensor

1. 作成したディレクトリに、インストールファイルの内容を抽出します。 この手順の間、Sensor は以下のファイルをインストールします。

<table id="table_C9E8803E51D046FD8FCCA38F8DAC04D1">
 <thead>
  <tr>
   <th colname="col1" class="entry"> ファイル </th>
   <th colname="col2" class="entry"> 説明 </th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td colname="col1"> EventMessages.dll </td>
   <td colname="col2"> イベントビューアメッセージ </td>
  </tr>
  <tr>
   <td colname="col1"> qlog.dll </td>
   <td colname="col2"> コレクタモジュール（ISAPI フィルタ）。 </td>
  </tr>
  <tr>
   <td colname="col1"> TestExperiment.xls </td>
   <td colname="col2"> <p>アーキテクトが対照実験の設定に使用できる Excel スプレッドシートファイル。 </p> <p>センサーはこのファイルを使用しません。 </p> </td>
  </tr>
  <tr>
   <td colname="col1"> trust_ca_cert.pem </td>
   <td colname="col2"> 接続プロセス中に Insight サーバーが提示する電子証明書を検証するために使用される証明書です。 </td>
  </tr>
  <tr>
   <td colname="col1"> TXLog.exe </td>
   <td colname="col2"> トランスミッタープログラム。 </td>
  </tr>
  <tr>
   <td colname="col1"> txlogd.conf </td>
   <td colname="col2"> Sensor 設定ファイル。 </td>
  </tr>
 </tbody>
</table>

>[!NOTE]
>
>インストールパッケージには、TestExperiment.xls という名前のスプレッドシートファイルが含まれています。 このスプレッドシートは、アーキテクトが対照実験の設定に使用するツールです。 センサー自体はこのファイルを使用しないので、Sensor が実行されているマシンにファイルをインストールする必要はありません（ただし、インストールすることは可能です）。 代わりに、アーキテクトがアクセスできる場所にファイルをコピーするか、必要に応じてインストールパッケージからファイルを抽出します。 対照実験の詳細については、『 Insight 対照実験ガイド』を参照してください。

## Sensor 設定ファイルを編集します。 {#section-1e1590a92222430e92066292512ae0df}

txlogd.conf ファイルには、Sensor の設定パラメーターが含まれています。

ファイルを編集して、ディスクキューのサイズ、Insight サーバーのアドレス、このセンサーによって生成されるデータに添付される ID を指定する必要があります。 設定ファイルには、必須のパラメーターとオプションのパラメーターが含まれています。

* **必須パラメーター** は、Sensor をインストールする際に指定する必要がある設定です。 これらの設定がないと、センサーは正常に動作しません。
* **オプションのパラメーター** は、事前定義済みの値（変更可能）をデフォルトにする設定またはオプション機能を有効にする設定です。

**Sensor 設定ファイルを編集するには**

1. を開きます。 `<SensorDirectory>/txlogd.conf` ファイルを編集し、必要なパラメーターと必要なオプションパラメーターを設定します。

   詳しくは、 [!DNL txlogd.conf] パラメータ， 「 [センサーの txlogd.conf ファイルのパラメーター](../../../home/c-snsr-ovrvw/sensor-txlogd-params/sensor-txlogd-params.md#concept-4bb629f058894b4abc65a31eb02eebed).

1. ファイルを保存して閉じます。

## トランスミッターを起動し、ディスクキューを作成します。 {#section-2b8dfd06996d4ab49998eeb99bd9f5f0}

設定後、 [!DNL txlogd.conf]ファイルを開くと、トランスミッタープログラムを起動し、Windows サービスとして登録し、ディスクキューを作成できます。

1. Windows の [ スタート ] メニューから、[ アクセサリ ] > [ コマンドプロンプト ] を選択します。
1. コマンドプロンプトウィンドウで、Sensor をインストールしたディレクトリに移動し、次のコマンドを実行します。

   ```
   txlog /regserver
   ```

   このコマンドは、トランスミッターを起動し、ディスクキューを作成し、Sensor を Windows サービスとして登録します。

1. トランスミッターが正しく実行されていることを確認するには、スタート/Campaign コントロールパネル/管理ツール/サービスをクリックします。

   >[!NOTE]
   >
   >このコマンドの順序は、使用している Windows のバージョンによって異なる場合があります。

   1. サービスリストで、Sensor のエントリを探し、そのステータスが「開始済み」で、起動タイプが「自動」であることを確認します。
   1. [ サービス ] コントロールパネルを閉じます。

1. 起動中にトランスミッターでエラーが発生したかどうかを確認するには、スタート/Campaign コントロールパネル/管理ツール/イベントビューアをクリックして、イベントビューアを開きます。

   >[!NOTE]
   >
   >このコマンドの順序は、使用している Windows のバージョンによって異なる場合があります。

   1. [Event Viewer] ウィンドウの左ペインで、[Applications] ログを選択します。
   1. 右側のウィンドウで、「ソース」列に「Adobe」があるイベントを探します。
   1. 「Adobe」からエラーが見つかった場合は、そのエラーをダブルクリックして「イベントのプロパティ」ウィンドウを表示します。 このウィンドウには、エラーに関する詳細情報が表示されます。

1. アプリケーションログの調査が終了したら、イベントビューアを閉じます。
1. トランスミッターが Sensor プログラムファイルをインストールしたディレクトリにディスクキュー (Diskq2008.log) を作成し、txlogd.conf ファイルの QueueSize パラメーターで指定したサイズであることを確認します。

   キューが正しく作成されていない場合：

   1. txtlogd.conf ファイルを調べ、QueueSize パラメーターが正しく設定されていることを確認します。
   1. Sensor をインストールしたデバイスに、QueueSize パラメータで指定したサイズのファイルを保持するのに十分な空き容量があることを確認します。
   1. Windows のサービスコントロールパネルで、トランスミッターを停止します。
   1. キューファイルを削除します。
   1. センサーを Windows サービスとして再登録：Windows の [ スタート ] メニューから、[ アクセサリ ] > [ コマンドプロンプト ] を選択します。 コマンドプロンプトウィンドウで、Sensor をインストールしたディレクトリに移動し、次のコマンドを実行します。

      ```
      txlog /regserver
      ```

トランスミッターは、連続的に実行するように設計されています。 コンピューターを再起動すると、トランスミッターが自動的に再起動します。 トランスミッターを手動で起動および停止する必要がある場合は、Windows の [ サービス ] コントロールパネルを使用して実行できます。

## Web サーバーにコレクターを追加する {#section-088960c986cf449cb712152298b3518d}

IIS の場合、コレクターは IIS の Web サーバーに追加する ISAPI フィルターです。

1. 次を使用して IIS Manager を開きます。 **スタート/管理ツール/インターネットインフォメーションサービス (IIS) マネージャー**.
1. を展開します。 **ローカルコンピュータ** および **サイト** ノード。
1. Web サイトを選択し、右側のウィンドウでダブルクリックします。 **ISAPI フィルタ**.
1. 以下 **アクション** ウィンドウで、 **追加**.

1. 内 **フィルター名** 「 」フィールドで、フィルターの表示名を入力します。 推奨されるフィルター名は「Sensor」です。
1. クリック **参照**&#x200B;をクリックし、qlog.dll ファイル（Sensor をインストールしたディレクトリ内）を選択して、 **OK**.

1. クリック **OK** をクリックしてフィルターを追加します。

   フィルターを追加すると、コレクターが直ちに動作し、データを収集する準備が整います。

コレクターにトラフィックが流れた後に緑色の矢印が表示されない場合は、次の手順に従います。

1. スタート/管理ツール/イベントビューアをクリックして、イベントビューアでエラーを確認します。

   >[!NOTE]
   >
   >このコマンドの順序は、使用している Windows のバージョンによって異なる場合があります。

1. [ イベントビューア ] ウィンドウの左ペインで、 **アプリ** ログ。
1. 右側のウィンドウで、「Adobe」が **ソース** 列。
1. エラーが見つかった場合は、エラーをダブルクリックして、 **イベントのプロパティ** ウィンドウ

## 追加データのキャプチャ {#section-98db9625efdc4b60bfd76f7adf4af74d}

Web ページは、多くの場合、ASP(Active Server Pages) プログラミング言語を使用して構造化されます。

ASP は、IIS 内で動作するMicrosoftテクノロジーです。 ブラウザが ASP ファイルを要求すると、IIS はその要求を ASP エンジンに渡します。 ASP エンジンは、ASP ファイルを 1 行ずつ読み取り、ファイル内のスクリプトを実行します。 最後に、ASP ファイルがプレーンHTMLとしてブラウザに返されます。 ASP は、RESPOND または REQUEST オブジェクトを提供し、他の利用方法に加えて、HTML・フォームから送信されたユーザー・クエリやデータの応答やリクエストを許可します。

場合によっては、ユーザーのブラウザーのアドレスバー内に表示される URL や、HTMLコード自体に表示可能な URL に、フォームに入力された値を追加したくないことがあります。 簡単なサーバー側 ASP スクリプトを使用すると、フォームフィールド名とそれぞれの値を、ユーザーのブラウザー内で使用したり、HTMLファイルに埋め込んだりしなくても、ログファイルに追加できます。 Web サイト内の特定のフォームに入力された実際のフォーム値を取り込むには、数行のコードを追加して、フォーム値をログリクエストに追加する必要があります。

フォームの処理ページ内で、次のコードを追加して、入力したフォームの値を（送信したフォームの値を外部データベースやその他の場所に書き込むのに加えて）要求データに追加します。

```
var sName= Request.Form("Name");
var sCity= Request.Form("City");
var sState= Request.Form("State");
var sZip= Request.Form("Zip");

Response.AppendToLog("&v_1=" +  sName);
Response.AppendToLog("&v_2=" +  sCity);
Response.AppendToLog("&v_3=" +  sState);
Response.AppendToLog("&v_4=" +  sZip);
```

このプロセスは、フォーム処理ページのリクエストデータに定義されたとおりのフォーム値を追加します。 ログデータ内では、追加された値がフォーム処理ページのクエリ文字列として使用できます（下図を参照）。 例えば、v_1、v_2、v_3 および v_4 は、適切なフォームフィールドに入力されたデータを含むクエリ文字列になります。 前の例で説明した構文は、取り込む追加のフォームフィールドおよび値に対して複製できます。

```
https://www.myserver.com/path/to/formprocessingpage.asp?v_1=John+Smith&v_2=Los+Angeles&v_3=California&v_4=90210
```

すべてのフォームフィールドと値を取り込んで分析に使用する場合は、次の構文を使用できます。

```
var formvalues = Response.Form;
Response.AppendToLog(formvalues);
```

次の例では、HTML内に存在するすべてのフォームフィールドとそれぞれの値を取り込み、クエリ文字列としてフォーム処理ページのログエントリに追加します。 これには、フォーム内に存在する非表示のフィールドが含まれます。

ログデータは、次の表で詳しく説明するように拡張されます。

| 収集されたデータ | 説明 | 例 |
|---|---|---|
| v_1 | NAME クエリ文字列に関連付けられた値 | v_1=John Smith |
| v_2 | CITY クエリ文字列に関連付けられた値 | v_2=ロサンゼルス |
| v_3 | STATE クエリ文字列に関連付けられた値 | v_3=カリフォルニア |
| v_4 | ZIP クエリ文字列に関連付けられた値 | v_4=90210 |

<!-- <a id="section_55C623AC973246DC9EBECD48DA1EE0F7"></a> -->
