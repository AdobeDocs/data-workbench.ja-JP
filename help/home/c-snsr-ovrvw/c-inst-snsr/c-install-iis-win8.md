---
description: Microsoft Windows Server 2008 以降で実行しているMicrosoft IIS 7.x または 8.x 用の Sensor をインストールして設定します。
title: Microsoft IIS（Windows Server 2008 以降）
uuid: 7fd8da68-1553-4395-b13e-b08a6ee1948e
exl-id: cc909daa-60c0-4188-8e90-035c41bf3105
source-git-commit: 79981e92dd1c2e552f958716626a632ead940973
workflow-type: tm+mt
source-wordcount: '1589'
ht-degree: 1%

---

# Microsoft IIS（Windows Server 2008 以降）{#microsoft-iis-on-windows-server-or-later}

Microsoft Windows Server 2008 以降で実行しているMicrosoft IIS 7.x または 8.x 用の Sensor をインストールして設定します。

Sensor 用のプログラムファイルは、インストールファイルにパッケージ化され、Adobeのダウンロードサイトから入手できます。 お使いの Web サーバー用の Sensor インストールファイルがまだない場合は、次の手順を開始する前に、このファイルをダウンロード ( またはAdobe担当者から入手 ) してください。

Sensor をインストールして設定するには、次の大まかな手順を実行する必要があります。

1. [プログラムファイルのインストール](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-cb51e5932a6d40c5b00758a7a51b7578)
1. [センサー設定ファイルの編集](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-1e1590a92222430e92066292512ae0df)
1. [トランスミッターを起動し、ディスクキューを作成します。](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-2b8dfd06996d4ab49998eeb99bd9f5f0)
1. [Web サーバーにコレクターを追加します。](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-088960c986cf449cb712152298b3518d)
1. [追加データのキャプチャ](../../../home/c-snsr-ovrvw/c-inst-snsr/c-install-iis-win8.md#section-98db9625efdc4b60bfd76f7adf4af74d)

## プログラムファイルのインストール {#section-cb51e5932a6d40c5b00758a7a51b7578}

Windows IIS で Sensor を実行する場合は、プログラムファイルとディスクキューファイルが同じディレクトリに存在する必要があります。

プログラムファイルをインストールする前に、まず、ディスクキューを保持する場所を決めます。これは、プログラムファイルをインストールする必要がある場所です。

次の手順を実行して、Sensor 用のプログラムファイルを抽出し、インストールします。

1. Windows マシンで、Sensor プログラムファイルをインストールするディレクトリを作成します。 ディスクキューもこのディレクトリに存在するので、選択したデバイスに必要なサイズのキューを保持するのに十分な領域があることを確認してください。

   例：C:\VisualSensor

1. 作成したディレクトリに、インストールファイルの内容を抽出します。 この手順の間、Sensor は次のファイルをインストールします。

<table id="table_C9E8803E51D046FD8FCCA38F8DAC04D1">
 <thead>
  <tr>
   <th colname="col1" class="entry"> ファイル </th>
   <th colname="col2" class="entry"> 説明 </th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td colname="col1"> EventMessages.dll </td>
   <td colname="col2"> イベントビューアメッセージ </td>
  </tr>
  <tr>
   <td colname="col1"> qlog.dll </td>
   <td colname="col2"> コレクターモジュール（ISAPI フィルター）。 </td>
  </tr>
  <tr>
   <td colname="col1"> TestExperiment.xls </td>
   <td colname="col2"> <p>アーキテクトが対照実験の設定に使用できる Excel スプレッドシートファイル。 </p> <p>センサーはこのファイルを使用しません。 </p> </td>
  </tr>
  <tr>
   <td colname="col1"> trust_ca_cert.pem </td>
   <td colname="col2"> 接続プロセス中に Insight サーバーが提示する電子証明書の検証に使用される証明書。 </td>
  </tr>
  <tr>
   <td colname="col1"> TXLog.exe </td>
   <td colname="col2"> 送信プログラム。 </td>
  </tr>
  <tr>
   <td colname="col1"> txlogd.conf </td>
   <td colname="col2"> Sensor 設定ファイル。 </td>
  </tr>
 </tbody>
</table>

>[!NOTE]
>
>このインストールパッケージには、TestExperiment.xls というスプレッドシートファイルが含まれています。 このスプレッドシートは、アーキテクトが対照実験を設定する際に使用するツールです。 センサー自体はこのファイルを使用しないので、Sensor を実行しているマシンにファイルをインストールする必要はありません（ただし、インストールは可能です）。 代わりに、アーキテクトがアクセスできる場所にファイルをコピーするか、必要に応じてインストールパッケージからファイルを抽出します。 対照実験の詳細については、『 Insight 対照実験ガイド』を参照してください。

## センサー設定ファイルの編集 {#section-1e1590a92222430e92066292512ae0df}

txlogd.conf ファイルには、Sensor の設定パラメーターが含まれています。

ファイルを編集して、ディスクキューのサイズ、Insight サーバーのアドレス、このセンサーで生成されるデータに添付される ID を指定する必要があります。 設定ファイルには、必須のパラメーターとオプションのパラメーターが含まれています。

* **必須パ** ラメータは、Sensor をインストールする際に指定する必要がある設定です。これらの設定がないと、センサーは正常に動作しません。
* **オプシ** ョンのパラメータは、事前定義された値（変更可能）をデフォルトにする設定またはオプション機能を有効にする設定です。

**Sensor 設定ファイルを編集するには**

1. `<SensorDirectory>/txlogd.conf` ファイルをテキストエディターで開き、必要なパラメーターと必要なオプションパラメーターを設定します。

   [!DNL txlogd.conf] パラメーターの説明については、[Sensor Txlogd.conf File Parameters](../../../home/c-snsr-ovrvw/sensor-txlogd-params/sensor-txlogd-params.md#concept-4bb629f058894b4abc65a31eb02eebed) を参照してください。

1. ファイルを保存して閉じます。

## トランスミッターを起動し、ディスクキューを作成します。 {#section-2b8dfd06996d4ab49998eeb99bd9f5f0}

[!DNL txlogd.conf] ファイルを設定した後、トランスミッタープログラムを起動し、Windows サービスとして登録し、ディスクキューを作成できます。

1. Windows の [ スタート ] メニューから、[ アクセサリ ]&gt;[ コマンドプロンプト ] を選択します。
1. コマンドプロンプトウィンドウで、Sensor をインストールしたディレクトリに移動し、次のコマンドを実行します。

   ```
   txlog /regserver
   ```

   このコマンドは、トランスミッターを起動し、ディスクキューを作成し、Sensor を Windows サービスとして登録します。

1. トランスミッターが正しく実行されていることを確認するには、スタート/Campaign コントロールパネル/管理ツール/サービスをクリックします。

   >[!NOTE]
   >
   >このコマンドの順序は、使用している Windows のバージョンによって異なる場合があります。

   1. サービスリストで、Sensor のエントリを探し、そのステータスが「開始済み」で、起動タイプが「自動」であることを確認します。
   1. [ サービス ] コントロールパネルを閉じます。

1. 起動中にトランスミッターでエラーが発生したかどうかを確認するには、スタート/Campaign コントロールパネル/管理ツール/イベントビューアをクリックして、イベントビューアを開きます。

   >[!NOTE]
   >
   >このコマンドの順序は、使用している Windows のバージョンによって異なる場合があります。

   1. [Event Viewer] ウィンドウの左側のペインで、[Applications] ログを選択します。
   1. 右側のウィンドウで、「ソース」列に「Adobe」が含まれるイベントを探します。
   1. 「Adobe」からエラーが見つかった場合は、そのエラーをダブルクリックして「イベントのプロパティ」ウィンドウを表示します。 このウィンドウには、エラーに関する詳細情報が表示されます。

1. アプリケーション・ログの確認が完了したら、イベント・ビューアを閉じます。
1. トランスミッターが Sensor プログラム・ファイルをインストールしたディレクトリにディスク・キュー (Diskq2008.log) を作成し、txlogd.conf ファイルの QueueSize パラメーターで指定したサイズであることを確認します。

   キューが正しく作成されていない場合：

   1. txtlogd.conf ファイルを調べ、QueueSize パラメーターが正しく設定されていることを確認します。
   1. Sensor をインストールしたデバイスに、QueueSize パラメータで指定したサイズのファイルを保持するのに十分な空き領域があることを確認します。
   1. Windows のサービスコントロールパネルを使用して、トランスミッターを停止します。
   1. キューファイルを削除します。
   1. センサーを Windows サービスとして再登録：Windows の [ スタート ] メニューから、[ アクセサリ ]&gt;[ コマンドプロンプト ] を選択します。 コマンドプロンプトウィンドウで、Sensor をインストールしたディレクトリに移動し、次のコマンドを実行します。

      ```
      txlog /regserver
      ```

トランスミッターは、連続的に動作するように設計されています。 マシンを再起動すると、トランスミッターが自動的に再起動します。 トランスミッターを手動で起動および停止する必要がある場合は、Windows の「サービス」コントロールパネルを使用します。

## Web サーバーにコレクターを追加します。 {#section-088960c986cf449cb712152298b3518d}

IIS の場合、コレクターは IIS の Web サーバーに追加する ISAPI フィルターです。

1. **スタート/管理ツール/インターネットインフォメーションサービス (IIS) マネージャー** を使用して、IIS マネージャーを開きます。
1. **ローカルコンピュータ** と **サイト** ノードを展開します。
1. Web サイトを選択し、右側のウィンドウで、「**ISAPI Filters**」をダブルクリックします。
1. **Actions** ウィンドウで、「**Add**」をクリックします。

1. 「**フィルター名**」フィールドに、フィルターの表示名を入力します。 推奨されるフィルター名は「Sensor」です。
1. 「**参照**」をクリックし、（Sensor をインストールしたディレクトリにある）qlog.dll ファイルを選択して、「**OK**」をクリックします。

1. 「**OK**」をクリックして、フィルターを追加します。

   フィルターを追加すると、コレクターが直ちに動作し、データを収集する準備が整います。

コレクターにトラフィックが流れた後に緑色の矢印が表示されない場合は、次の手順を実行します。

1. スタート/管理ツール/イベントビューアをクリックして、イベントビューアにエラーがないかどうかを確認します。

   >[!NOTE]
   >
   >このコマンドの順序は、使用している Windows のバージョンによって異なる場合があります。

1. [Event Viewer] ウィンドウの左側のペインで、**[Application**] ログを選択します。
1. 右側のウィンドウで、**Source** 列に「Adobe」があるイベントを探します。
1. エラーが見つかった場合は、エラーをダブルクリックして **イベントのプロパティ** ウィンドウを表示します。

## 追加データのキャプチャ {#section-98db9625efdc4b60bfd76f7adf4af74d}

Web ページは、多くの場合、ASP(Active Server Pages) プログラミング言語を使用して構造化されます。

ASP は、IIS 内で動作するMicrosoftテクノロジーです。 ブラウザが ASP ファイルを要求すると、IIS はその要求を ASP エンジンに渡します。 ASP エンジンは、ASP ファイルを 1 行ずつ読み取り、ファイル内のスクリプトを実行します。 最後に、ASP ファイルがプレーンHTMLとしてブラウザに返される。 ASP は、他の利用に加えて、HTML・フォームから送信されたユーザー・クエリやデータの応答や要求を可能にする RESPOND または REQUEST オブジェクトを提供します。

場合によっては、ユーザーのブラウザーのアドレスバー内に表示される URL や、HTMLコード自体に表示可能な URL に、フォームに入力された値を追加しないことがあります。 サーバー側の簡単な ASP スクリプトを使用すると、フォームのフィールド名とそれぞれの値を、ユーザーのブラウザー内で使用したり、HTMLファイルに埋め込んだりせずに、ログファイルに追加できます。 Web サイト内の特定のフォームに入力される実際のフォーム値を取り込むには、数行のコードを追加して、フォーム値をログリクエストに追加する必要があります。

フォームの処理ページ内で、次のコードを含めて、入力したフォーム値を（送信されたフォーム値を外部データベースやその他の場所に書き込むのに加えて）要求データに追加します。

```
var sName= Request.Form("Name");
var sCity= Request.Form("City");
var sState= Request.Form("State");
var sZip= Request.Form("Zip");

Response.AppendToLog("&v_1=" +  sName);
Response.AppendToLog("&v_2=" +  sCity);
Response.AppendToLog("&v_3=" +  sState);
Response.AppendToLog("&v_4=" +  sZip);
```

このプロセスは、フォーム処理ページの要求データに定義されたとおりのフォーム値を追加します。 ログデータ内では、追加された値がフォーム処理ページのクエリ文字列として使用できます（下図を参照）。 例えば、v_1、v_2、v_3 および v_4 は、適切なフォームフィールドに入力されたデータを含むクエリー文字列になります。 前の例で説明した構文は、取り込む追加のフォームフィールドおよび値に対して複製できます。

```
https://www.myserver.com/path/to/formprocessingpage.asp?v_1=John+Smith&v_2=Los+Angeles&v_3=California&v_4=90210
```

すべてのフォームフィールドと値を取り込んで分析に使用する場合は、次の構文を使用できます。

```
var formvalues = Response.Form;
Response.AppendToLog(formvalues);
```

次の例では、HTML内に存在するすべてのフォームフィールドとそれぞれの値を取り、それらをクエリ文字列としてフォーム処理ページのログエントリに追加します。 これには、フォーム内に存在する非表示のフィールドが含まれます。

ログデータは、次の表で詳しく説明するように拡張されます。

| 収集されたデータ | 説明 | 例 |
|---|---|---|
| v_1 | NAME クエリ文字列に関連付けられた値 | v_1=John Smith |
| v_2 | CITY クエリ文字列に関連付けられた値 | v_2=ロサンゼルス |
| v_3 | STATE クエリ文字列に関連付けられた値 | v_3=カリフォルニア |
| v_4 | ZIP クエリ文字列に関連付けられた値 | v_4=90210 |

<!-- <a id="section_55C623AC973246DC9EBECD48DA1EE0F7"></a> -->
